
import java.util.ArrayList;

/**
 *This is the object class, which holds stuff like the information about a vuln like what command to execute to find it, what that 
 * output compares to, which computers the vuln works on.
 * @author Ryan
 */
public class Vulnerability
{
    private final String[] certifiedComputers;    //This holds all of the computers the vuln. can work on
    private ArrayList<RemoteArgs> findCommand;             //This is the command that can see if the vuln is solved or not
    private String compareOutput;           //compares the output to see if the find command returned the necessary info
    private ArrayList<RemoteArgs> createCommand;           //This is the command to create this vuln if necessary
    private final boolean whichOS;                //This has 2 forms, false for Windows and true for Linux
    public static final boolean LINUX = true;     //an answer for whichOS
    public static final boolean WINDOWS = false;  //an answer for whichOS
    public static final String UBUNTU12 =  "UBUNTU12";  //type of certified Computer
    public static final String UBUNTU14 = "UBUNTU14";
    public static final String WINDOWS7 = "WINDOWS7";
    public static final String WINDOWS8 = "WINDOWS8";
    public static final String WINDOWSSERVER2008 = "WINDOWSSERVER2008";
    private final int worthPoints;
    private final String name;
    
    public Vulnerability(boolean whichOS, String[] certifiedComputers, ArrayList<RemoteArgs> findCommand, String compareOutput, ArrayList<RemoteArgs> createCommand, int worthPoints, String name)
    {
        this.certifiedComputers = certifiedComputers;
        this.findCommand = findCommand;
        this.whichOS = whichOS;
        this.createCommand = createCommand;
        this.name = name;
        this.worthPoints = worthPoints;
        this.compareOutput = compareOutput;
    }
    
    /**
     * Tests to see if the computer given can use this Vulnerability.
     * @param computer - The type of computer that you want to test.
     * @return - If the Vulnerability can be used in {@code computer}
     */
    protected boolean isComputerCertified(String computer)  //Computer should be one of the defined variables above.
    {
        for (int i = 0; i < certifiedComputers.length; i++)
        {
            if (certifiedComputers[i].equals(computer))
                return true;
        }
        return false;
    }
    
    /**
     * @return - Returns the command to create the Vulnerability onto the computer
     */
    protected ArrayList<RemoteArgs> toCreateVuln()
    {
        return createCommand;
    }
    
    /**
     * 
     * @return - The command to execute on the computer to determine if the Vulnerability is on the computer.
     */
    protected ArrayList<RemoteArgs> toFindVuln()   //returns the command that can be executed on the computer in order to determine if the computer has the vuln or not.
    {
        return findCommand;
    }
    
    protected int pointsWorth()
    {
        return worthPoints;
    }
    
    protected void setFindCommand(ArrayList<RemoteArgs> command)
    {
        findCommand = command;
    }
    
    protected void setCreateCommand(ArrayList<RemoteArgs> command)
    {
        findCommand = command;
    }
}
